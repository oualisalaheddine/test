<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<title>Opération</title>
<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" />
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"> -->
<link rel="stylesheet" th:href="@{/select2/css/select2.min.css}" />
<style>
.card {
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
	border: 1px solid #e9ecef;
	border-radius: 8px;
}

.form-label {
	font-weight: 500;
	color: #495057;
}
</style>
</head>
<body class="bg-light">
	<div class="container-fluid py-5">
		<div class="row justify-content-center">
			<div class="col-lg-12">
				<div class="card">
					<div class="card-header bg-white border-0 pt-4">
						<h1 class="h3 mb-0 text-center">Enregistrement d'opération</h1>
					</div>
					<div class="card-body pb-0">
						<form
							th:action="${operation.id} != null ? @{'/pontbascule/operations/' + ${operation.id}} : @{/pontbascule/operations}"
							method="post">
							<div class="row g-4">
								<!-- Colonne Gauche -->
								<div class="col-md-4">


									<div class="mb-3">
										<label for="typeOperationId" class="form-label">Type
											d'opération</label> <select id="typeOperationId"
											name="typeOperationId" class="form-select">
											<option value="" disabled selected>Choisir un type
												d'opération</option>
											<option th:each="t : ${types}" th:value="${t.id}"
												th:selected="${operation.typeOperation?.id == t.id}"
												th:text="${t.libelle}"></option>
										</select>
									</div>

									<div class="mb-3">
										<label for="produitId" class="form-label">Produit</label> <select
											id="produitId" name="produitId" class="form-select">
											<option value="" disabled selected>Choisir un
												produit</option>
											<option th:each="p : ${produits}" th:value="${p.idProduit}"
												th:selected="${operation.produit?.idProduit == p.idProduit}"
												th:text="${p.designationProduit}"></option>
										</select>
									</div>

									<div class="mb-3">
										<label for="partenaireId" class="form-label">Partenaire</label>
										<select id="partenaireId" name="partenaireId"
											class="form-select">
											<option value="" disabled selected>Choisir un
												partenaire</option>
											<option th:each="pt : ${partenaires}" th:value="${pt.id}"
												th:selected="${operation.partenaire?.id == pt.id}"
												th:text="${pt.raisonSociale}"></option>
										</select>
									</div>



								</div>

								<!-- Colonne Milieu -->
								<div class="col-md-4">


									<div class="mb-3">
										<label class="form-label">Immatriculation</label> <input
											type="text" name="immatriculation"
											th:value="${operation.immatriculation}" class="form-control">
									</div>

									<div class="mb-3">
										<label class="form-label">Chauffeur</label> <input type="text"
											name="chauffeur" th:value="${operation.chauffeur}"
											class="form-control">
									</div>

									<div class="mb-3">
										<label class="form-label">Pesée 1</label> <input type="number"
											name="peser1" th:value="${operation.peser1}"
											class="form-control" step="0.01">
									</div>

									<div class="mb-3">
										<label class="form-label">Pesée 2</label> <input type="number"
											name="peser2" th:value="${operation.peser2}"
											class="form-control" step="0.01">
									</div>

								</div>


								<!-- Colonne Droite -->
								<div class="col-md-4">

									<div class="mb-3">
										<label class="form-label">Numero de Facture ou BL</label> <input
											type="number" name="factureNumero"
											th:value="${operation.factureNumero}" class="form-control">
									</div>

									<div class="mb-3">
										<label class="form-label">Date Facture ou BL</label> <input
											type="date" name="dateFacture"
											th:value="${operation.dateFacture}" class="form-control">
									</div>



									<div class="mb-3">
										<label class="form-label">Quantité déclarée</label> <input
											type="number" name="qteDeclare"
											th:value="${operation.qteDeclare}" class="form-control"
											step="0.01">
									</div>
									<div class="mb-3">
										<label class="form-label">Commentaire</label> <input
											type="text" name="commentaire"
											th:value="${operation.commentaire}" class="form-control">
									</div>
								</div>
							</div>

							<input type="hidden" name="operationEnCoursId"
								th:value="${operation.operationEnCoursId}">

							<div
								class="d-grid gap-3 d-md-flex justify-content-md-end mt-4 mb-3">
								<a th:href="@{/pontbascule}" class="btn btn-outline-secondary">Retour</a>
								<button type="submit" class="btn btn-primary">Enregistrer</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script th:src="@{/js/jquery-3.7.1.min.js}"></script>
	<!-- <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>  -->
	<script th:src="@{/select2/js/select2.min.js}"></script>
	<script th:src="@{/js/bootstrap.bundle.min.js}"></script>

	<script>
		$(document).ready(function() {
			// Configuration Select2 avec recherche locale
			$('.form-select').select2({
				theme : 'bootstrap-5',
				allowClear : true,
				width : '100%',
				// Recherche côté client (pas de requête serveur)
				minimumInputLength : 0,
				// Cache les résultats pour la performance
				cache : true
			});
		});
	</script>
	
	<script>
		$(document).ready(function() {
			// Initialiser Select2 pour le type d'opération
			$('#typeOperationId').select2({
				
				placeholder : 'Choisir un type d\'opération',
				allowClear : true,
				
			});

			// Initialiser Select2 pour le produit
			$('#produitId').select2({
				
				placeholder : 'Choisir un produit',
				allowClear : true,
				width : '100%'
			});

			//Initialiser Select2 pour le partenaire
			$('#partenaireId').select2({
				
				placeholder : 'Choisir un partenaire',
				allowClear : true,
				width : '100%'
			});
		});
	</script>

</body>
</html>